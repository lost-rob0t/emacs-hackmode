#+title: Environment Variables

* Environment Variables
hackmode sets up environment variables to integrate with external tools and scripts. These variables are automatically configured when you switch operations or initialize hackmode.

** Core Variables
*** HACKMODE_OP
- *Purpose*: Contains the name of the current operation
- *Example*: =client-webapp-2024=, =forest.htb=, =bug-bounty-program=
- *Set by*: =hackmode-switch-op=, =hackmode-init=

*** HACKMODE_PATH  
- *Purpose*: Absolute path to the current operation's directory
- *Example*: =/home/user/hackmode/client-webapp-2024=
- *Set by*: =hackmode-switch-op=, =hackmode-init=

** Storage Locations
These environment variables are persisted in files for consistency across shell sessions:

- =~/.local/share/hackmode/current-op= - Contains the operation name
- =~/.local/share/hackmode/op-path= - Contains the operation directory path

** Integration Examples
*** Bash Scripts
#+begin_src bash
#!/bin/bash
# Use hackmode environment in external scripts
echo "Current operation: $HACKMODE_OP"
echo "Working in: $HACKMODE_PATH"

# Write scan results to operation directory
nmap -sn 192.168.1.0/24 > "$HACKMODE_PATH/scans/network-discovery.txt"
#+end_src

*** Python Scripts
#+begin_src python
import os

# Get current hackmode context
current_op = os.getenv('HACKMODE_OP', 'default')
op_path = os.getenv('HACKMODE_PATH', '.')

print(f"Operating on: {current_op}")
print(f"Base path: {op_path}")

# Write findings to operation directory
with open(f"{op_path}/findings/automated-scan.txt", "w") as f:
    f.write("Scan results here...")
#+end_src

** Direnv Integration
If =direnv= is installed, hackmode automatically creates =.envrc= files in operation directories to ensure proper environment isolation:

#+begin_src bash
# Example .envrc content
export HACKMODE_OP="client-webapp-2024"
export HACKMODE_PATH="/home/user/hackmode/client-webapp-2024"
#+end_src

** Troubleshooting
*** Variables Not Set
If environment variables aren't available:
1. Ensure you've initialized an operation: =M-x hackmode-init=
2. Check if =~/.local/share/hackmode/= directory exists
3. Verify operation files contain valid paths

*** Direnv Not Working
If =.envrc= files aren't being loaded:
1. Install =direnv= and add it to your shell
2. Run =direnv allow= in operation directories
3. Ensure =direnv= hook is in your shell configuration
